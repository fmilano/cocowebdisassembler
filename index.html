 
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Minimal JS front-end App Example</title>
  <script src="./src/model/section.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" type="text/javascript"></script>
  <script src="./src/view/hex0r.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="./src/view/hex0r.css" />
</head>
<body>
  <h1>Color Computer web disassembler</h1>
  <h2>An Example of a Minimal JavaScript web front-end disassembler</h2>
  <p>This app supports the following operations:</p>
  <input type="file" id="files" name="files[]" single />
  <output id="list"></output>

  <div id="hexViewer" class="hex0rwindow" data-row-width="16" data-word-size="1" data-row-break="8"
    data-trim="true" data-base64="true" data-caption="Hex0r Example - base 64 file, with highlighting"
    data-highlights=""
    data-show-line-nums="true" title="">
    /9j/4AAQSkZJRgABAQEASABIAAD/4RzmRXhpZgAATU0AKgAAAAgADAEPAAIAAAAJ AAAAngEQAAIAAAAQAAAAqAESAAMAAAABAAEAAAEaAAUAAAABAAAAuAEbAAUAAAAB
    AAAAwAEoAAMAAAABAAIAAAExAAIAAAAvAAAAyAEyAAIAAAAUAAAA+AITAAMAAAAB AAIAAIKYAAIAAAAFAAABDIdpAAQAAAABAAABEsSlAAcAAAAcAAAEkAAABKxGVUpJ
    RklMTQAARmluZVBpeCBGNDU1ICAgAAAAAEgAAAABAAAASAAAAA==
</div>

  <script type="module">
    import { decbParse } from './src/modules/decb_parser.mjs';

    console.hex = (d) => console.log((Object(d).buffer instanceof ArrayBuffer ? new Uint8Array(d.buffer) : 
      typeof d === 'string' ? (new TextEncoder('utf-8')).encode(d) : 
      new Uint8ClampedArray(d)).reduce((p, c, i, a) => p + (i % 16 === 0 ? i.toString(16).padStart(6, 0) + '  ' : ' ') + 
      c.toString(16).padStart(2, 0) + (i === a.length - 1 || i % 16 === 15 ? 
      ' '.repeat((15 - i % 16) * 3) + Array.from(a).splice(i - i % 16, 16).reduce((r, v) => 
      r + (v > 31 && v < 127 || v > 159 ? String.fromCharCode(v) : '.'), '  ') + '\n' : ''), ''));

    function handleFileSelect(evt) {
      var file = evt.target.files[0]; // FileList object
  
      document.getElementById('list').innerHTML = '<ul><strong>', escape(file.name), '</strong></ul>';

      var reader = new FileReader();

      reader.onload = function () {
        let retVal = decbParse(reader.result)
        console.log(retVal.sections[0].data);
        let base64String = btoa(String.fromCharCode(...new Uint8Array(retVal.sections[1].data)));
        console.log(base64String);
        document.getElementById('hexViewer').innerHTML = base64String;

        markup_hex0rwindow($("#hexViewer"));
      }

      reader.readAsArrayBuffer(file);
    }
  
    document.getElementById('files').addEventListener('change', handleFileSelect, false);
  </script>

  <!--<menu>
    <li><a href="listSections.html"><button type="button">List all sections</button></a></li>
    <li><a href="createSection.html"><button type="button">Add a new section</button></a></li>
    <li><a href="updateSection.html"><button type="button">Update a section</button></a></li>
    <li><a href="deleteSection.html"><button type="button">Delete a section</button></a></li>
    <li><button type="button" onclick="Section.clearData()">Clear database</button></li>
    <li><button type="button" onclick="Section.createTestData()">Create test data</button></li>
  </menu>-->
</body>
</html>